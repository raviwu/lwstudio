<!DOCTYPE html>
<html>
<head>
	<meta name="generator" content="Hugo 0.75.1" />
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Ravi Wu - random thoughts and notes, beware if you want to reference </title><link rel="icon" type="image/png" href=favicon.ico /><meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="alternate" type="application/rss+xml" href="https://raviwu.github.io/index.xml" title="Ravi Wu" />
	<meta property="og:title" content="Ravi Wu" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://raviwu.github.io/" />
<meta property="og:updated_time" content="2020-10-28T12:05:03+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ravi Wu"/>
<meta name="twitter:description" content=""/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://raviwu.github.io/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://raviwu.github.io/css/main.css" />
	<link rel="stylesheet" type="text/css" href="https://raviwu.github.io/css/custom.css" />
	<link rel="stylesheet" type="text/css" href="https://raviwu.github.io/css/dark.css"  />
	<link rel="stylesheet" type="text/css" href="https://raviwu.github.io/css/custom-dark.css"  />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	<script src="https://raviwu.github.io/js/main.js"></script>
	<script src="https://raviwu.github.io/js/abc.js"></script>
	<script src="https://raviwu.github.io/js/xyz.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	<base href="https://raviwu.github.io/">
	<h1 class="site-title"><a href="https://raviwu.github.io/">Ravi Wu</a></h1>
	<div class="site-description"><h2>random thoughts and notes, beware if you want to reference</h2><nav class="nav social">
			<ul class="flat"><a href="https://github.com/raviwu" title="Github"><i data-feather="github"></i></a><a href="https://www.linkedin.com/in/raviwu/" title="Linkedin"><i data-feather="linkedin"></i></a><a href="/index.xml" title="RSS"><i data-feather="rss"></i></a></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">All posts</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
		</ul>
	</nav>
</div>


		

		<div class="recent-posts section">
			<h2 class="section-header">
				Recent posts
			</h2>
			<div class="posts">
				
				
				
				<div class="post">
					<div class="meta">Oct 28, 2020</div>
					<a class="title" href="/posts/go-type/">Go | 型別（Type）</a> &mdash;
					<span class="description">
						
						Go 的型別（Type）可以讓編譯器知道兩樣資訊：
 需要使用的記憶體大小 這些記憶體所代表的內容  以內建的型別為例：
   型別 記憶體大小 內容     int64 8 bytes 整數   float32 4 bytes IEEE-754 浮點數   bool 1 byte true OR false    有一些型別所代表的內容會跟著 build 機器的不同架構有所差異，例如同樣的 int 在 64 位元電腦裡佔 8 bytes 但在 32 位元電腦裡只佔 4 bytes。&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">Oct 26, 2020</div>
					<a class="title" href="/posts/go-map/">Go | Map</a> &mdash;
					<span class="description">
						
						Go 的 map 是鍵值對的資料結構。
// 宣告一個空白 map colors := map[string]string{} // 加入或修改鍵值對 colors[&#34;Yello&#34;] = &#34;#cc8500&#34; // 刪除鍵值（鍵不存在時並不會噴錯誤） delete(colors, &#34;Red&#34;) // 宣告一個空 map var numbers map[int]string numbers[1] = &#34;One&#34; // panic: runtime error: assignment ot entry in nil map 檢查鍵是否存在，如果指定的鍵不存在，會回傳零值給 value&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">Oct 26, 2020</div>
					<a class="title" href="/posts/go-slice/">Go | 切片（Slice）</a> &mdash;
					<span class="description">
						
						切片（Slice）是操作其指向之陣列（Array）的物件。
[指標|長度|最大長度] // 切片 | [1,2,3,4,5] // 陣列 切片的初始化 // 宣告一個長度與最大長度都是 5 的字串陣列 slice1 := make([]string, 5) // 宣告一個長度為 3 最大長度為 5 的整數陣列 slice2 := make([]int, 3, 5) 長度不能大於最大長度，不然編譯器會噴錯誤。一般來說，宣告切片的同時也會同時賦值：&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">Oct 26, 2020</div>
					<a class="title" href="/posts/go-array/">Go | 陣列（Array）</a> &mdash;
					<span class="description">
						
						Go 的陣列是連續空間內儲存了固定數目之相同型別物件的容器。當使用 var array [5]int 宣告時，陣列內儲存的型別或者長度都不能再改變，如果需要更多的空間來儲存新的物件，需要宣告一個新的陣列後把原先的值搬過去新的陣列。
在 Go 語言中宣告新的變數且無賦值時，這些變數所指向的物件都會以其零值（Zero Value）初始化。有關於 Go 的零值，請參考這邊。常用的零值：
   類型 零值     數值 0   布林值 false   字串 &quot;&quot;    初始化陣列的同時賦值 // 宣告一個 array1 變數的 int 陣列，長度為 5 且值依序分別為 1,2,3,4,5 array1 := [5]int{1,2,3,4,5} // 宣告一個 array2 變數的 int 陣列，長度為 5 且值依序分別為 0,1,2,0,0 array2 := [5]int{1: 1, 2: 2} // 宣告一個 array3 變數的 int 陣列，長度為取決於賦值內容 // 如以下 array3 的長度為 3 array3 := [.&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">Sep 2, 2016</div>
					<a class="title" href="/posts/use-find-in-batches-during-migration/">利用 find_in_batches 在 Rails 做跨資料庫的資料移轉操作</a> &mdash;
					<span class="description">
						
						在處理跨資料庫搬動並且需要一筆一筆資料去做各種運算處理時，最直覺的方式，是把表格裡的所有資料通通透過 ORM 撈到 ActiveRecord::Association 陣列裡，再用 each 去做操作：
User.all.each do |user| user.email = &#34;assign@new.email&#34; ... end 但由於 Rails 會需要先去建立這些 objects，如果資料筆數很多的話，一次通通撈出來會佔用過多不必要的記憶體，可以使用 find_in_batches 做批次處理，減少系統 RAM 的負擔。&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">Jul 9, 2016</div>
					<a class="title" href="/posts/pull-data-to-rails-from-google-sheet/">使用 Google Sheets API 拉資料到 Rails APP 裡</a> &mdash;
					<span class="description">
						
						Google Sheets 很好用，一些程式中需要跨部門討論的字串定義，又或者是需要讓不方便存取原始碼的同事也能清楚知道原始碼裡部分設定字串的時候，通常都可以利用 Google Sheet 來做討論平台，再以 Google Sheets 上面的文件為基礎，匯入主程式中做各種處理，確保主程式的內容與 Google Sheets 上的內容同步。
要匯入 Google Sheets 內容到程式裡最簡單的方式，是輸出 csv 後寫個小 script 去讀取 csv 資料，轉成 Array 後就能靈活使用。&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">Jun 24, 2016</div>
					<a class="title" href="/posts/migrate-push-notification-from-parse-to-aws-sns/">在 rails 上實作轉移 Parse 手機推播服務到 Amazon SNS</a> &mdash;
					<span class="description">
						
						簡要說明 為了避免使用者因服務轉換而被迫強制更新，移轉過程採用漸進方式。
如果不需要如此痛苦的同時使用兩種服務的捧油，可以參考這一篇的實作，直接用 AWS Mobile Hub 的服務做批次資料移轉。
由於在轉換期需要同時支援兩邊服務運作，又要避免使用者重複收到相同的推播，需要實作「對同一裝置擇一服務進行推播」。本篇實作的概念是，使用者只有在用新版本的 APP 登入時，伺服器才會從 APP 取得 device_token 去註冊 Amazon SNS endpoint_arn，同時刪除 Parse 服務上的使用者的所有 Installation 紀錄。&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">Jun 10, 2016</div>
					<a class="title" href="/posts/implement-jwt-in-grape-api/">Rails grape API 上實作 JWT 多重登入</a> &mdash;
					<span class="description">
						
						多重登入的需求，在服務本身允許「跨裝置體驗」或者是「接受不同 request agent (APP request / mobile browser)」的時候顯得重要。
理想情況下，可以讓使用者在介面上面清楚知道目前帳號的登入狀態，並在登入數超過服務上限的時候，讓使用者自己選擇要移除登入授權的裝置，使用者流程大概會像（這篇文）那樣，要做到類似參考連結這樣的管理介面，需要我目前還不會的前端的配合建置與基本的 session 管理 API。本篇只先建置允許使用多重登入的資料結構與登入驗證 API。
選擇用 JWT (Jason Web Token) 作為主要的憑證溝通，優點有一些：
 透過加密 payload 來比對資料庫內容的方式，可以不用在資料表中「直接存入」與憑證相關的訊息，加密跟解密只要透過協定就能進行調整。 payload 裡面塞入的訊息可以自訂，在各服務跟裝置之間交換加密過後的使用者資料。 signing key / protocol 可以在有資安疑慮時更換。  使用 Devise 的 Rails 捧油也可參考 devise_token_auth 這個 gem，整合效果在文件上面看起來很完善，但因為目前我手邊的系統絕大多數的 request 都來自 grape API endpoint ，比較過後，跟搞懂並駕馭 devise 設定比起來，我還是選擇自刻 JWT 較節省開發時間。&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">May 12, 2016</div>
					<a class="title" href="/posts/use-paperclip-to-store-uri-in-rails/">Rails 中使用 Paperclip 存 URI 附件</a> &mdash;
					<span class="description">
						
						使用 Rails APP + Paperclip Gem 做附件存取系統，靜態檔案的資料夾格式預設是跟著 id 跑（ /000/000/000/ 九碼化的 ID 切成 3 階資料夾），最近因為要做資料庫合併，大批的資料會被賦予新的 ID，原先放在 AWS S3 上面的靜態資料夾結構就會 mapping 錯誤，必須要依照新的 ID 去存放相對應的資料夾結構。&hellip;
						
					</span>
				</div>
				
				<div class="post">
					<div class="meta">Apr 15, 2016</div>
					<a class="title" href="/posts/early-termination/">程設風格 | 早期終止執行</a> &mdash;
					<span class="description">
						
						剛開始寫程式的時候，以為所謂邏輯判斷就是很多個若 A 則 B 包起來的複雜地圖。這樣的程式碼，很容易因為邏輯判斷太過複雜，很難一眼就看到到底目前程式會跑到哪一個 if 分支裡面執行。
taget = Dog.new if target.is_a?(Animal) if target.has_four_legs? if target.is_a?(Dog) puts &#34;wolf!&#34; else puts &#34;four leg animal can say yeah&#34; end else puts &#34;don&#39;t know what that is&#34; end else puts &#34;don&#39;t know what that is&#34; end =&gt; &#34;wolf!&hellip;
						
					</span>
				</div>
				
				

<ul class="pagination">
	<li class="page-item page-prev">
	
	</li>
	<li class="page-item page-next">
	
    <a href="/page/2/" class="page-link" aria-label="Next"><span aria-hidden="true">Next page →</span></a>
	
	</li>
</ul>


			</div>
		</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> Copyright © 2020 | Ravi Wu |  <a href="https://github.com/vividvilla/ezhil">Ezhil theme</a> | Built with <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>



<script>feather.replace()</script>
</body>
</html>
